<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">

<head>
<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script
	src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"></script>
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>
<meta charset="utf-8" />
<title>Todo List</title>
</head>

<body>
	<div class="container">
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown"
				aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNavDropdown">
				<ul class="navbar-nav">
					<li class="nav-item active"><a class="nav-link" href="#">Home
							<span class="sr-only">(current)</span>
					</a></li>
					<li class="nav-item"><a class="nav-link" href="#">Brands</a></li>
					<li class="nav-item"><a class="nav-link" href="#">Categories</a>
					</li>
					<li class="nav-item dropdown"><a
						class="nav-link dropdown-toggle" href="#"
						id="navbarDropdownMenuLink" data-toggle="dropdown"
						aria-haspopup="true" aria-expanded="false"> Dropdown link </a>
						<div class="dropdown-menu"
							aria-labelledby="navbarDropdownMenuLink">
							<a class="dropdown-item" href="#">Action</a> <a
								class="dropdown-item" href="#">Another action</a> <a
								class="dropdown-item" href="#">Something else here</a>
						</div></li>
				</ul>
			</div>
			<div class="navbar-nav navbar-right">
				<ul class="navbar-nav">
					<li class="nav-item dropdown"><a
						class="nav-link dropdown-toggle" href="#"
						id="navbarDropdownMenuLink" data-toggle="dropdown"
						aria-haspopup="true" aria-expanded="false"> Logged in as <span
							sec:authentication="principal.username"> User</span></a>
						<div class="dropdown-menu"
							aria-labelledby="navbarDropdownMenuLink">
							<span class="navbar-text" sec:authorize="isAuthenticated()">
								<a class="dropdown-item" th:href="@{/logout}">Logout</a>
							</span>
						</div></li>
				</ul>
			</div>
		</nav>
	</div>
	<div class="container mt-7">
		<h1>Todo List</h1>
		<h2>
			Welcome <span sec:authentication="principal.username"> User</span>
		</h2>
		<a href="/add-todo">Create New Todo</a> <br /> <br />
		<table class="table table-sm table-condensed table-striped">
			<thead>
				<tr>
					<th>ID</th>
					<th>User</th>
					<th>Description</th>
					<th>Target Date</th>
					<th>Star Meter</th>
					<th>Edit</th>
					<th>Delete</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="todo : ${todos}">
					<td th:text="${todo.id}"></td>
					<td th:text="${todo.user}"></td>
					<td th:text="${todo.description}"></td>
					<td th:text="${todo.targetDate}"></td>
					<td th:text="${todo.starMeter}"></td>
					<td><a th:href="@{'/edit/' + ${todo.id}}"
						class="btn btn-info btn-sm">Edit</a></td>
					<td>
						<button type="button" class="btn btn-danger btn-sm"
							data-toggle="modal" th:attr="data-target='#'+${todo.id}">Delete</button>
						<!-- Modal -->
						<div class="modal fade" th:attr="id=${todo.id}" tabindex="-1"
							role="dialog" aria-labelledby="exampleModalLabel"
							aria-hidden="true">
							<div class="modal-dialog" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="exampleModalLabel"
											th:text="'Delete User (' + ${todo.user} + ')'"></h5>
										<button type="button" class="close" data-dismiss="modal"
											aria-label="Close">
											<span aria-hidden="true">&times;</span>
										</button>
									</div>
									<div class="modal-body">
										<p class="text-danger"
											th:text="'Are you sure to delete this user (' + ${todo.user} + ')?'"></p>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-warning btn-sm"
											data-dismiss="modal">Cancel</button>
										<a th:href="@{'/delete/' + ${todo.id}}"
											class="btn btn-danger btn-sm">Yes, Delete</a>
									</div>
								</div>
							</div>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</body>
</html>